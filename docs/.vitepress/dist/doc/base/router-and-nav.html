<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>路由和侧边栏 | 前端通用框架及工作流</title>
    <meta name="description" content="通用框架及工作流程管理用于解决效率、复用问题，使用Vue技术栈">
    <link rel="stylesheet" href="/admin-docs/assets/style.3fd4eeb0.css">
    <link rel="modulepreload" href="/admin-docs/assets/app.263436ba.js">
    <link rel="modulepreload" href="/admin-docs/assets/doc_base_router-and-nav.md.29b37c7b.lean.js">
    
    <link rel="icon" href="/fe.ico">
  <meta name="twitter:title" content="路由和侧边栏 | 前端通用框架及工作流">
  <meta property="og:title" content="路由和侧边栏 | 前端通用框架及工作流">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/admin-docs/" aria-label="前端通用框架及工作流, back to home" data-v-675d8756 data-v-cc01ef16><!----> 前端通用框架及工作流</a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/admin-docs/" data-v-b8818f8c>首页 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/admin-docs/guide/" data-v-b8818f8c>暴力指南 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/admin-docs/doc/base/guide" data-v-b8818f8c>框架文档 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/admin-docs/standard/standard" data-v-b8818f8c>编码格式 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/admin-docs/git/git" data-v-b8818f8c>Git管理 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/mrhaoxiaojun/mini-ui-design" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>UI 组件 <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><!----></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/admin-docs/" data-v-b8818f8c>首页 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/admin-docs/guide/" data-v-b8818f8c>暴力指南 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/admin-docs/doc/base/guide" data-v-b8818f8c>框架文档 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/admin-docs/standard/standard" data-v-b8818f8c>编码格式 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/admin-docs/git/git" data-v-b8818f8c>Git管理 <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/mrhaoxiaojun/mini-ui-design" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>UI 组件 <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><!--]--><!----><!----></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><p class="sidebar-link-item">基础</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/admin-docs/doc/base/guide">介绍</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/admin-docs/doc/base/layout">布局</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item active" href="/admin-docs/doc/base/router-and-nav">路由和侧边栏</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#路由配置项">路由配置项</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#路由模式">路由模式</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#侧边栏">侧边栏</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#"></a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#点击侧边栏-刷新当前路由">点击侧边栏 刷新当前路由</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#面包屑（快捷导航栏）">面包屑（快捷导航栏）</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#侧边栏滚动问题">侧边栏滚动问题</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#侧边栏默认展开">侧边栏默认展开</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/admin-docs/doc/base/permission">权限验证</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/admin-docs/doc/base/new-page">新增页面</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/admin-docs/doc/base/style">样式</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/admin-docs/doc/base/server">和服务器交互</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/admin-docs/doc/base/mock">模拟数据</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/admin-docs/doc/base/import">引入外面模块</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/admin-docs/doc/base/deploy">构建和发布</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/admin-docs/doc/base/env">环境变量</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">进阶</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/admin-docs/doc/advanced/components">内部组件</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/admin-docs/doc/advanced/eslint">ESLint</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/admin-docs/doc/advanced/chart">图表</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/admin-docs/doc/advanced/cors">跨域问题</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/admin-docs/doc/advanced/style-guide">风格指南</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/admin-docs/doc/advanced/error">错误处理</a><!----></li></ul></li><li class="sidebar-link"><p class="sidebar-link-item">其他</p><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/admin-docs/doc/thanks">鸣谢</a><!----></li></ul></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><h1 id="路由和侧边栏" tabindex="-1">路由和侧边栏 <a class="header-anchor" href="#路由和侧边栏" aria-hidden="true">#</a></h1><p>路由和侧边栏是组织起一个后台应用的关键骨架。</p><p>本项目解决了侧边菜单过多所带来的痛点。其他框架的痛点问题：菜单过多导致的展示不全需要来回滚动、多种菜单无法分类展示、需要顶部栏目的系统无法实现。本框架解决方式：在header位置添加栏目列表，各个栏目下的子集为侧边菜单，切换栏目侧边菜单联动切换。</p><p>路由采用静态路由加动态路由的方案，使得路由数据前后分离后端鉴权更加容易。静态路由存放本地无需鉴权（例如404页面、登陆页面），动态路由通过接口获取并添加。</p><div class="tip custom-block"><p class="custom-block-title">不需要动态路由</p><p>如果不需要动态路由，关闭权限过滤功能，全局配置filterMenu设置为false，自行维护<code>router/static.router.ts</code>文件</p></div><h2 id="路由配置项" tabindex="-1">路由配置项 <a class="header-anchor" href="#路由配置项" aria-hidden="true">#</a></h2><p>首先我们了解一下本项目配置路由时提供了哪些配置项。</p><div class="language-ts"><pre><code><span class="token keyword">interface</span> <span class="token class-name">RouterObj</span> <span class="token punctuation">{</span>
  <span class="token comment">// 菜单id</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>
  <span class="token comment">// 路由地址</span>
  path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  <span class="token comment">// 菜单名称</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  <span class="token comment">// 相对于views文件夹的模板文件的相对位置</span>
  component<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  <span class="token comment">// 路由名称</span>
  key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  <span class="token comment">// 重定向地址</span>
  redirect<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  <span class="token comment">// 菜单图标</span>
  icon<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  <span class="token comment">// 菜单子集，页面级无需配置</span>
  children<span class="token operator">?</span><span class="token operator">:</span> RouterObj<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// 父级id</span>
  pid<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>
  <span class="token comment">// 是否隐藏页面/菜单，默认false不隐藏</span>
  hidden<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span>
  <span class="token comment">// 是否缓存页面，默认false不缓存</span>
  keepAlive<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>
<span class="token punctuation">}</span>

</code></pre></div><p>框架路由配置项与vue-router配置的对应关系</p><table><thead><tr><th>框架路由配置项</th><th>vue-router配置项</th><th>注释</th></tr></thead><tbody><tr><td>id</td><td><a href="http://meta.id" target="_blank" rel="noopener noreferrer">meta.id</a></td><td>路由元信息</td></tr><tr><td>path</td><td>path</td><td>路由地址</td></tr><tr><td>name</td><td>meta.title</td><td>路由元信息</td></tr><tr><td>component</td><td>component</td><td>模板文件位置</td></tr><tr><td>key</td><td>name</td><td>路由名称（需唯一）</td></tr><tr><td>redirect</td><td>redirect</td><td>重定向</td></tr><tr><td>icon</td><td>无</td><td>框架特有</td></tr><tr><td>children</td><td>children</td><td>路由子集</td></tr><tr><td>pid</td><td>无</td><td>框架特有</td></tr><tr><td>hidden</td><td>meta.hidden</td><td>路由元信息</td></tr><tr><td>keepAlive</td><td>meta.keepAlive</td><td>路由元信息</td></tr></tbody></table><p><strong>示例</strong></p><p>后端返回示意：</p><div class="language-ts"><pre><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span> 
    id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    pid<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">&#39;基础模板&#39;</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> <span class="token string">&#39;/&#39;</span><span class="token punctuation">,</span>
    redirect<span class="token operator">:</span> <span class="token string">&#39;/element/icon&#39;</span><span class="token punctuation">,</span>
    component<span class="token operator">:</span> <span class="token string">&#39;BasicLayout&#39;</span><span class="token punctuation">,</span>
    icon<span class="token operator">:</span> <span class="token string">&#39;AppleOutlined&#39;</span><span class="token punctuation">,</span>
    key<span class="token operator">:</span> <span class="token string">&#39;layout&#39;</span><span class="token punctuation">,</span>
    children<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        pid<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        name<span class="token operator">:</span> <span class="token string">&#39;好用组件&#39;</span><span class="token punctuation">,</span>
        path<span class="token operator">:</span> <span class="token string">&#39;/element&#39;</span><span class="token punctuation">,</span>
        redirect<span class="token operator">:</span> <span class="token string">&#39;/element/icon&#39;</span><span class="token punctuation">,</span>
        component<span class="token operator">:</span> <span class="token string">&#39;RouteView&#39;</span><span class="token punctuation">,</span>
        icon<span class="token operator">:</span> <span class="token string">&#39;ChromeOutlined&#39;</span><span class="token punctuation">,</span>
        key<span class="token operator">:</span> <span class="token string">&#39;element&#39;</span><span class="token punctuation">,</span>
        children<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            id<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
            pid<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            name<span class="token operator">:</span> <span class="token string">&#39;图标组件&#39;</span><span class="token punctuation">,</span>
            path<span class="token operator">:</span> <span class="token string">&#39;/element/icon&#39;</span><span class="token punctuation">,</span>
            redirect<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
            component<span class="token operator">:</span> <span class="token string">&#39;/element/icon&#39;</span><span class="token punctuation">,</span>
            icon<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
            key<span class="token operator">:</span> <span class="token string">&#39;el_icon&#39;</span><span class="token punctuation">,</span>
            keepAlive<span class="token operator">:</span> <span class="token boolean">true</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            id<span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span>
            pid<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            name<span class="token operator">:</span> <span class="token string">&#39;表格组件&#39;</span><span class="token punctuation">,</span>
            path<span class="token operator">:</span> <span class="token string">&#39;/element/table&#39;</span><span class="token punctuation">,</span>
            redirect<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
            component<span class="token operator">:</span> <span class="token string">&#39;/element/table&#39;</span><span class="token punctuation">,</span>
            icon<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
            key<span class="token operator">:</span> <span class="token string">&#39;el_table&#39;</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            id<span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
            pid<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            name<span class="token operator">:</span> <span class="token string">&#39;详情&#39;</span><span class="token punctuation">,</span>
            path<span class="token operator">:</span> <span class="token string">&#39;/element/detail&#39;</span><span class="token punctuation">,</span>
            redirect<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
            component<span class="token operator">:</span> <span class="token string">&#39;/element/detail&#39;</span><span class="token punctuation">,</span>
            icon<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
            key<span class="token operator">:</span> <span class="token string">&#39;detail&#39;</span><span class="token punctuation">,</span>
            hidden<span class="token operator">:</span> <span class="token boolean">true</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

</code></pre></div><h2 id="路由模式" tabindex="-1">路由模式 <a class="header-anchor" href="#路由模式" aria-hidden="true">#</a></h2><p>这里的路由分为两种，<code>constantRoutes</code> 和 <code>asyncRoutes</code>。</p><p>constantRoutes：代表那些不需要动态判断权限且配置在本地的路由，如登录页、404、等通用页面。</p><p>asyncRoutes：代表那些后端返回需要动态判断权限并通过 addRoute 添加的页面。</p><p>上边路由配置项配置的是动态路由，静态路由只需在本地按照vue-router格式配置 (src/router/basics.router.ts)即可</p><div class="tip custom-block"><p class="custom-block-title">提示</p><p>这里所有的路由页面都使用 路由懒加载 了 ，具体介绍见<a href="https://next.router.vuejs.org/zh/guide/advanced/lazy-loading.html" target="_blank" rel="noopener noreferrer">文档</a></p></div><div class="warning custom-block"><p class="custom-block-title">注意事项</p><p>这里有一个需要非常注意的地方就是 404 页面一定要最后加载，需要在 addRoute 添加完后端路由后添加通配符404，如果提前配置会导致动态路由被拦击到404页面。(src/router/permission.ts)</p></div><h2 id="侧边栏" tabindex="-1">侧边栏 <a class="header-anchor" href="#侧边栏" aria-hidden="true">#</a></h2><p>本项目侧边栏主要基于 ant-design 的 a-menu 改造。</p><p>侧边栏是通过后端接口返回的路由数组生成的，支持路由无限嵌套，路径、栏目、菜单相互联动，侧边栏显示的菜单为当前栏目的可视菜单。登陆后默认跳转地址&quot;/&quot;，这也要求你必须保证定义路经为&quot;/&quot;的路由，当然你可以修改这个地址。</p><div class="tip custom-block"><p class="custom-block-title">提示</p><p>修改登陆后默认跳转地址，只需要替换login.vue (src/views/login)中的&#39;/&#39;部分（80行附近）</p></div><p>在后台返回路由组的时候会在vuex存入 state.user.routers ，这里缓存了整体路由列表，在header栏目生成时调取该缓存数据，取 state.user.routers index = 0的层级为栏目。</p><p>所选栏目的下属子路由存入 state.menu.menuRouter , 这里缓存了侧边栏路由列表，并且根据用户选择的不用栏目实时更新。侧边栏循环 state.menu.menuRouter ，每一项定义为item， item含有children为菜单，不含有的为页面。</p><p><strong>侧边栏逻辑图</strong></p><p><a href="../imgs/menuul.jpg"><img src="/admin-docs/assets/menuul.b4054540.jpg" alt=""></a></p><p>仔细阅读上图并查看源码，你会很快梳理通顺这部分的逻辑，根据路由地址进行的菜单与tab的联动也是在此基础之上开发的，如果你对这部分感兴趣可以继续深入了解(src/layout)部分的源代码。在侧边栏部分你只需要了解即可，因为这部分内容并不会影响到你的使用，除非你想DIY某些东西。</p><div class="tip custom-block"><p class="custom-block-title">提示</p><p>侧边栏菜单的打开与关闭是<a href="https://2x.antdv.com/components/menu-cn#API" target="_blank" rel="noopener noreferrer">antd menu</a>组件提供的支持</p></div><h2 id="" tabindex="-1"><a class="header-anchor" href="#" aria-hidden="true">#</a></h2><p>如果你的路由是多级目录，不要忘记在菜单部分设置component: BlankView，原则上有多少级路由嵌套就需要多少个BlankView（除顶级栏目和页面）。</p><div class="language-ts"><pre><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&#39;栏目一&#39;</span>
    component<span class="token operator">:</span> <span class="token string">&#39;BasicLayout&#39;</span><span class="token punctuation">,</span>
    children<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        name<span class="token operator">:</span> <span class="token string">&#39;菜单一&#39;</span>
        component<span class="token operator">:</span> <span class="token string">&#39;BlankView&#39;</span>
        children<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">&#39;菜单嵌套层一&#39;</span>
            component<span class="token operator">:</span> <span class="token string">&#39;BlankView&#39;</span>
            children<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

</code></pre></div><p><strong>component</strong><br> 为BasicLayout是框架主体部分，栏目需设置；<br> 为BlankView是视图窗口，菜单需设置。</p><p><a href="../imgs/nested.png"><img src="/admin-docs/assets/nested.d556554b.png" alt=""></a></p><h2 id="点击侧边栏-刷新当前路由" tabindex="-1">点击侧边栏 刷新当前路由 <a class="header-anchor" href="#点击侧边栏-刷新当前路由" aria-hidden="true">#</a></h2><p>在用 spa(单页面应用) 这种开发模式之前，用户每次点击侧边栏都会重新请求这个页面，用户渐渐养成了点击侧边栏当前路由来刷新 view 的习惯。但现在 spa 就不一样了，用户点击当前高亮的路由并不会刷新 view，因为 vue-router 会拦截你的路由，它判断你的 url 并没有任何变化，所以它不会触发任何钩子或者是 view 的变化。<a href="https://github.com/vuejs/vue-router/issues/296" target="_blank" rel="noopener noreferrer">issue ()</a>地址，社区也对该问题展开了激烈讨论。</p><p><a href="../imgs/ydd.png"><img src="/admin-docs/assets/ydd.5f6903cb.png" alt=""></a></p><p>尤大本来也说要增加一个方法来强刷 view，但后来他又改变了心意/(ㄒ o ㄒ)/~~。但需求就摆在这里，我们该怎么办呢？他说了不改变 current URL 就不会触发任何东西，那我可不可以强行触发你的 hook 呢？上有政策， 下有对策我们变着花来 hack。方法也很简单，通过不断改变 url 的 query 来触发 view 的变化。我们监听侧边栏每个 link 的 click 事件，每次点击都给 router push 一个不一样的 query 来确保会重新刷新 view。</p><div class="tip custom-block"><p class="custom-block-title">注意</p><p>这里只是提供给大家一个解决思路，实际框架内点击侧边栏是没有添加刷新功能的。</p></div><div class="language-ts"><pre><code><span class="token function">clickLink</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    path<span class="token punctuation">,</span>
    query<span class="token operator">:</span> <span class="token punctuation">{</span>
      t<span class="token operator">:</span> <span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//保证每次点击路由的query项都是不一样的，确保会重新刷新view</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><p>ps:不要忘了在 router-view 加上一个特定唯一的 key，如 <code>&lt;router-view :key=&quot;$route.path&quot;&gt;&lt;/router-view&gt;</code>， 但这也有一个弊端就是 url 后面有一个很难看的 query 后缀如 xxx/article/list?t=1496...，当然你可以从前面的 issue 中知道还有很多其它方案。</p><p><strong>相关例子</strong></p><p>这里在介绍一种比较推荐的方案（来自<a href="https://github.com/PanJiaChen" target="_blank" rel="noopener noreferrer">潘大神</a>），现在采取的方案是判断当前点击的菜单路由和当前的路由是否一致，若一致的时候，会先跳转到一个专门 Redirect 的页面，它会将路由重定向到我想去的页面，这样就起到了刷新的效果了。</p><p>1、点击的时候重定向页面至 <code>/redirect</code></p><div class="language-ts"><pre><code><span class="token keyword">const</span> <span class="token punctuation">{</span> fullPath <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route
<span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  path<span class="token operator">:</span> <span class="token string">&#39;/redirect&#39;</span> <span class="token operator">+</span> fullPath
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><p>2、<code>redirect</code> 页面在重定向回原始页面</p><div class="language-ts"><pre><code><span class="token comment">// redirect.vue</span>
<span class="token comment">// https://github.com/PanJiaChen/vue-element-admin/blob/master/src/views/redirect/index.vue</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">beforeCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> params<span class="token punctuation">,</span> query <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route
    <span class="token keyword">const</span> <span class="token punctuation">{</span> path <span class="token punctuation">}</span> <span class="token operator">=</span> params
    <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">&#39;/&#39;</span> <span class="token operator">+</span> path<span class="token punctuation">,</span> query <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// avoid warning message</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="面包屑（快捷导航栏）" tabindex="-1">面包屑（快捷导航栏） <a class="header-anchor" href="#面包屑（快捷导航栏）" aria-hidden="true">#</a></h2><p>本项目中的tab切换栏充当面包屑的，如果需要传统的面包屑扩展一下即可，核心代码是围绕<code>route.matched</code>进行的</p><p><a href="../imgs/crumbs.png"><img src="/admin-docs/assets/crumbs.8c821533.png" alt=""></a></p><p>通过监听路由变化（<code>watch $route</code>）vuex动态缓存新访问的路由，在template内循环读取vuex缓存的数据，来展示出历史访问面包屑。在 <code>menu.vue</code> 你可以参照 <code>route.matched</code> 相关代码添加当前访问面包屑。</p><p><a href="../imgs/breadCrumbs.jpg"><img src="/admin-docs/assets/breadCrumbs.de8ed594.jpg" alt=""></a></p><p>历史面包屑点击相应的 tabItem 可以切换到点击的路由，右击 tabItem 可以打开操作菜单，在菜单中可以进行关闭的相关操作。</p><h2 id="侧边栏滚动问题" tabindex="-1">侧边栏滚动问题 <a class="header-anchor" href="#侧边栏滚动问题" aria-hidden="true">#</a></h2><p>现在许多前端框架容易忽略的一个问题，就是菜单过多超出预设 <code>100vh</code> 的时候，只是隐藏不显示没有进行滚动。该框架进行了css方面的优化处理，很好的规避了这种问题，并有美化了滚动条使他不在是难看的原生滚动条。</p><div class="language-css"><pre><code><span class="token selector">.layout</span> <span class="token punctuation">{</span>
  <span class="token selector">&amp; .ant-layout-sider-children</span> <span class="token punctuation">{</span>
    <span class="token property">overflow-y</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
    <span class="token property">overflow-x</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">&amp; .ant-layout-sider-children::-webkit-scrollbar</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">&amp; .ant-layout-sider-children::-webkit-scrollbar-thumb</span> <span class="token punctuation">{</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
    <span class="token property">box-shadow</span><span class="token punctuation">:</span> inset 0 0 5px #d8d8d8<span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> #535353<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">&amp; .ant-layout-sider-children::-webkit-scrollbar-track</span> <span class="token punctuation">{</span>
    <span class="token property">box-shadow</span><span class="token punctuation">:</span> inset 0 0 5px #d8d8d8<span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> #ededed<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="侧边栏默认展开" tabindex="-1">侧边栏默认展开 <a class="header-anchor" href="#侧边栏默认展开" aria-hidden="true">#</a></h2><p>某些场景下，用户需要默认展开侧边栏的某些sub-menu，如下图：</p><p><a href="../imgs/nested.png"><img src="/admin-docs/assets/nested.d556554b.png" alt=""></a></p><p>可以通过初始化设置 a-menu 的 openKeys 来达到目的，首先找到侧边栏代码(src/layout/menu)</p><div class="language-ts"><pre><code><span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> openKeys <span class="token operator">=</span> <span class="token generic-function"><span class="token function">ref</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><p>具体的逻辑代码你可以根据具体的业务需求编写。</p></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-07c132fc><div class="edit" data-v-07c132fc><div class="edit-link" data-v-07c132fc data-v-1ed99556><!----></div></div><div class="updated" data-v-07c132fc><!----></div></footer><div class="next-and-prev-link" data-v-7eddb2c4 data-v-38ede35f><div class="container" data-v-38ede35f><div class="prev" data-v-38ede35f><a class="link" href="/admin-docs/doc/base/layout" data-v-38ede35f><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-prev" data-v-38ede35f><path d="M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"></path></svg><span class="text" data-v-38ede35f>布局</span></a></div><div class="next" data-v-38ede35f><a class="link" href="/admin-docs/doc/base/permission" data-v-38ede35f><span class="text" data-v-38ede35f>权限验证</span><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-next" data-v-38ede35f><path d="M19.9,12.4c0.1-0.2,0.1-0.5,0-0.8c-0.1-0.1-0.1-0.2-0.2-0.3l-7-7c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l5.3,5.3H5c-0.6,0-1,0.4-1,1s0.4,1,1,1h11.6l-5.3,5.3c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l7-7C19.8,12.6,19.9,12.5,19.9,12.4z"></path></svg></a></div></div></div><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"doc_advanced_chart.md\":\"501e6a53\",\"doc_advanced_components.md\":\"f69fce95\",\"doc_advanced_cors.md\":\"3de661cc\",\"doc_advanced_error.md\":\"cb0279ae\",\"doc_advanced_eslint.md\":\"ed5a4e90\",\"doc_advanced_style-guide.md\":\"855cfea7\",\"doc_base_deploy.md\":\"a3a6acbd\",\"doc_base_env.md\":\"b2eda3aa\",\"doc_base_guide.md\":\"582951e0\",\"doc_base_import.md\":\"8713523c\",\"doc_base_layout.md\":\"e4ba8e9c\",\"doc_base_mock.md\":\"71076766\",\"doc_base_new-page.md\":\"db15fbcc\",\"doc_base_permission.md\":\"77fd26ad\",\"doc_base_router-and-nav.md\":\"29b37c7b\",\"doc_base_server.md\":\"7f514e90\",\"doc_base_style.md\":\"d25bf7c0\",\"doc_thanks.md\":\"57c2ae40\",\"git_cmd.md\":\"9ebb3ac1\",\"git_git.md\":\"7578f32f\",\"guide_index.md\":\"bbef2169\",\"index.md\":\"53fb0d51\",\"others_joincompany.md\":\"88610e49\",\"others_social.md\":\"44d66e46\",\"standard_more.md\":\"f6f59829\",\"standard_standard.md\":\"63e691e8\",\"tablelayout_disposition.md\":\"7876d276\",\"tablelayout_doubt.md\":\"4aadc13b\",\"tablelayout_event.md\":\"09176e98\",\"tablelayout_methods.md\":\"cc4f6858\",\"tablelayout_outline.md\":\"1dd9d716\",\"tablelayout_slot-notice.md\":\"c7b19e2b\",\"tablelayout_slot.md\":\"4f57a8c8\"}")</script>
    <script type="module" async src="/admin-docs/assets/app.263436ba.js"></script>
    
  </body>
</html>